"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5239],{5239:(Y,f,d)=>{d.r(f),d.d(f,{CollectionPageModule:()=>S});var _=d(6814),u=d(95),l=d(5548),g=d(1629),m=d(8180),e=d(6689),p=d(2860);function C(t,c){if(1&t&&(e.TgZ(0,"ion-title"),e._uU(1),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(null==n.collection?null:n.collection.name)}}function b(t,c){if(1&t&&(e.TgZ(0,"ion-row",18)(1,"ion-col",19)(2,"b"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-col",20)(5,"span"),e._uU(6),e.qZA()()()),2&t){const n=e.oxw().$implicit;e.xp6(3),e.hij(" ",n.key,": "),e.xp6(3),e.hij(" ",n.value," ")}}function v(t,c){if(1&t&&(e.ynx(0),e.TgZ(1,"ion-grid"),e.YNc(2,b,7,2,"ion-row",17),e.qZA(),e.BQk()),2&t){const n=c.$implicit;e.xp6(2),e.Q6J("ngIf","id"!==n.key)}}function x(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",13)(2,"ion-card")(3,"ion-card-content"),e.YNc(4,v,3,1,"ng-container",12),e.ALo(5,"keyvalue"),e.qZA(),e.TgZ(6,"div",14)(7,"ion-button",15),e.NdJ("click",function(){const s=e.CHM(n).$implicit,r=e.oxw(2);return e.KtG(r.onDelete(null==s?null:s.id))}),e._UZ(8,"ion-icon",16),e.qZA()()()()()}if(2&t){const n=c.$implicit,i=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",e.lcZ(5,2,n)),e.xp6(3),e.Q6J("disabled",i.disableActions)}}function y(t,c){if(1&t&&(e.ynx(0),e.YNc(1,x,9,4,"ion-row",12),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==n.collection?null:n.collection.items)}}function Z(t,c){if(1&t&&(e.TgZ(0,"ion-row")(1,"ion-col",21)(2,"b"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-col",21)(5,"span"),e._uU(6),e.qZA()()()),2&t){const n=e.oxw().$implicit;e.xp6(3),e.hij("",n.key,":"),e.xp6(3),e.hij(" ",n.value,"")}}function k(t,c){if(1&t&&(e.ynx(0),e.TgZ(1,"ion-grid"),e.YNc(2,Z,7,2,"ion-row",3),e.qZA(),e.BQk()),2&t){const n=c.$implicit;e.xp6(2),e.Q6J("ngIf","id"!==n.key)}}function w(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",13)(2,"ion-card")(3,"ion-card-content"),e.YNc(4,k,3,1,"ng-container",12),e.ALo(5,"keyvalue"),e.qZA(),e.TgZ(6,"div",14)(7,"ion-button",15),e.NdJ("click",function(){const s=e.CHM(n).$implicit,r=e.oxw(2);return e.KtG(r.onDelete(null==s?null:s.id))}),e._UZ(8,"ion-icon",16),e.qZA()()()()()}if(2&t){const n=c.$implicit,i=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",e.lcZ(5,2,n)),e.xp6(3),e.Q6J("disabled",i.disableActions)}}function I(t,c){if(1&t&&(e.ynx(0),e.YNc(1,w,9,4,"ion-row",12),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.collectionItemsFilteredSearch)}}function T(t,c){1&t&&(e.TgZ(0,"div",14)(1,"h3"),e._uU(2,"Looks like we couldn't find anything for your search!"),e.qZA()())}function P(t,c){if(1&t&&(e.ynx(0),e.YNc(1,T,3,0,"div",22),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.searchQuery.trim().length>0&&!n.collectionItemsFilteredSearch.length&&!n.searchingCollection)}}function A(t,c){if(1&t&&(e.TgZ(0,"ion-item"),e._UZ(1,"ion-input",28),e.qZA()),2&t){const n=c.$implicit;e.xp6(1),e.Q6J("label",n)("formControlName",n)("placeholder",n)("clearInput",!0)("required",!0)}}function Q(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",23),e.NdJ("click",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.cancel())}),e._uU(4,"Cancel"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"New item!"),e.qZA(),e.TgZ(7,"ion-buttons",24)(8,"ion-button",25),e.NdJ("click",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.confirm())}),e._uU(9,"Confirm"),e.qZA()()()(),e.TgZ(10,"ion-content",26)(11,"form",27)(12,"ion-list"),e.YNc(13,A,2,5,"ion-item",12),e.qZA()()()}if(2&t){const n=e.oxw();e.xp6(8),e.Q6J("disabled",!n.form.valid)("strong",!0),e.xp6(3),e.Q6J("formGroup",n.form),e.xp6(2),e.Q6J("ngForOf",null==n.collection?null:n.collection.attributes)}}const J=[{path:"",component:(()=>{var t;class c{constructor(i,o,s,r,a,h,N,q){this.config=i,this.navCtrl=o,this.activatedRoute=s,this.loadingCtrl=r,this.collectionsService=a,this.alertCtrl=h,this.toastCtrl=N,this.actionSheetCtrl=q,this.mode="ios",this.searchingCollection=!1,this.searchQuery="",this.collectionId="",this.collectionItemsFilteredSearch=[],this.fields=[],this.disableActions=!1,this._subscriptions=[]}ngOnInit(){var i;this.mode=this.config.get("mode"),null===(i=this.activatedRoute)||void 0===i||null===(i=i.paramMap)||void 0===i||i.subscribe(o=>{null!=o&&o.has("collectionId")?(this.collectionId=null==o?void 0:o.get("collectionId"),this.loadingCtrl.create({message:"Loading Collection..."}).then(s=>{s.present(),this.collectionsService.getCollection(this.collectionId).pipe((0,m.q)(1)).subscribe(r=>{(!r||!r.id)&&(s.dismiss(),this.alertCtrl.create({header:"Oops...!",subHeader:"It seems you encountered a problem!",message:"We couldn't load your collection!",buttons:[{text:"Back to Safety",role:"confirm",handler:()=>{this.navCtrl.navigateBack("/collections")}}]}).then(a=>{a.present()})),this.collection={...r},this.buildForm(),s.dismiss()})})):this.navCtrl.navigateBack("/collections")})}buildForm(){const i=this.getFormControlsFields();this.form=new u.cw(i)}getFormControlsFields(){const i={};for(const s of null===(o=this.collection)||void 0===o?void 0:o.attributes){var o;i[s]=new u.NI(null,{updateOn:"change",validators:[u.kI.required]}),this.fields.push(s)}return i}handleSearchInput(i){var o;this.searchingCollection=!0,this.searchQuery=i.target.value.toLowerCase().trim(),this.collectionItemsFilteredSearch=[...null===(o=this.collection)||void 0===o?void 0:o.items.filter(s=>{let r="";for(const[a,h]of Object.entries(s))r+=" "+h;return r.toLowerCase().indexOf(this.searchQuery)>-1})],this.searchingCollection=!1}onAddClicked(){}onDelete(i){this.disableActions=!0,this.actionSheetCtrl.create({header:"Are you sure you want to delete this item?",buttons:[{text:"Delete",role:"destructive",handler:()=>{this.loadingCtrl.create({message:"Deleting Item..."}).then(o=>{o.present(),this.collection=null,this.collectionsService.deleteCollectionItem(this.collectionId,i).subscribe(s=>{o.dismiss(),this.collectionsService.getCollection(this.collectionId).pipe((0,m.q)(1)).subscribe(r=>{if(!r||!r.id)return o.dismiss(),void this.alertCtrl.create({header:"Oops...!",subHeader:"It seems you encountered a problem!",message:"We couldn't load your collection!",buttons:[{text:"Back to Safety",role:"confirm",handler:()=>{this.navCtrl.navigateBack("/collections")}}]}).then(a=>{a.present()});this.collection={...r},o.dismiss(),this.toastCtrl.create({message:"Removed Successfully!",duration:1500,position:"bottom",icon:"checkmark-circle-outline",color:"success"}).then(a=>{a.present()})})})})}},{text:"Cancel",role:"cancel"}]}).then(o=>{o.present(),this.disableActions=!1})}cancel(){this.modal.dismiss(null,"cancel")}confirm(){console.log(this.form.value);const i={...this.form.value,id:Math.random().toString()};this.loadingCtrl.create({message:"Adding Item to your collection..."}).then(o=>{o.present(),this.collectionsService.addItemToCollection(this.collectionId,i).subscribe(s=>{s?this.collectionsService.getCollection(this.collectionId).pipe((0,m.q)(1)).subscribe(r=>{if(!r||!r.id)return o.dismiss(),void this.alertCtrl.create({header:"Oops...!",subHeader:"It seems you encountered a problem!",message:"We couldn't load your collection!",buttons:[{text:"Back to Safety",role:"confirm",handler:()=>{this.navCtrl.navigateBack("/collections")}}]}).then(a=>{a.present()});this.collection={...r},this.toastCtrl.create({message:"Item added Successfully!",duration:1500,position:"bottom",icon:"checkmark-circle-outline",color:"success"}).then(a=>{a.present(),this.modal.dismiss(null,"confirm"),o.dismiss(),this.form.reset()})}):this.toastCtrl.create({message:"Cold not add item!",duration:1500,position:"bottom",icon:"close-circle-outline",color:"danger"}).then(r=>{r.present()})})})}onWillDismiss(i){}ngOnDestroy(){this._subscriptions.forEach(i=>i.unsubscribe())}}return(t=c).\u0275fac=function(i){return new(i||t)(e.Y36(l.De),e.Y36(l.SH),e.Y36(g.gz),e.Y36(l.HT),e.Y36(p.c),e.Y36(l.Br),e.Y36(l.yF),e.Y36(l.BX))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-collection"]],viewQuery:function(i,o){if(1&i&&e.Gf(l.ki,5),2&i){let s;e.iGM(s=e.CRH())&&(o.modal=s.first)}},decls:20,vars:8,consts:[[3,"translucent"],["slot","start"],["defaultHref","/collections"],[4,"ngIf"],["slot","primary"],["id","open-modal-collection",3,"click"],["name","add-outline","slot","icon-only"],[3,"fullscreen"],["collapse","condense"],["size","small"],["show-cancel-button","focus","show-clear-button","always","placeholder","Search Item","animated","true","enterkeyhint","Search",3,"debounce","value","ionInput"],["trigger","open-modal-collection",3,"willDismiss"],[4,"ngFor","ngForOf"],["size-sm","6","offset-sm","3"],[1,"ion-text-center"],["fill","clear","color","danger",3,"disabled","click"],["slot","icon-only","name","trash-outline"],["class","key-value-row",4,"ngIf"],[1,"key-value-row"],["size","5",1,"ion-text-start"],["size","7",1,"ion-text-end"],["size","6"],["class","ion-text-center",4,"ngIf"],[3,"click"],["slot","end"],[3,"disabled","strong","click"],[1,"ion-padding"],[3,"formGroup"],["type","text","labelPlacement","floating",3,"label","formControlName","placeholder","clearInput","required"]],template:function(i,o){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.YNc(4,C,2,1,"ion-title",3),e.TgZ(5,"ion-buttons",4)(6,"ion-button",5),e.NdJ("click",function(){return o.onAddClicked()}),e._UZ(7,"ion-icon",6),e.qZA()()()(),e.TgZ(8,"ion-content",7)(9,"ion-header",8)(10,"ion-toolbar")(11,"ion-title",9),e._uU(12),e.qZA()()(),e.TgZ(13,"ion-grid")(14,"ion-searchbar",10),e.NdJ("value",function(){return o.searchQuery})("ionInput",function(r){return o.handleSearchInput(r)}),e.qZA(),e.YNc(15,y,2,1,"ng-container",3),e.YNc(16,I,2,1,"ng-container",3),e.YNc(17,P,2,1,"ng-container",3),e.qZA(),e.TgZ(18,"ion-modal",11),e.NdJ("willDismiss",function(r){return o.onWillDismiss(r)}),e.YNc(19,Q,14,4,"ng-template"),e.qZA()()),2&i&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("ngIf","ios"===o.mode),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(4),e.Oqu(null==o.collection?null:o.collection.name),e.xp6(2),e.Q6J("debounce",350),e.xp6(1),e.Q6J("ngIf",!o.searchQuery.trim().length),e.xp6(1),e.Q6J("ngIf",o.searchQuery.trim().length>0&&o.collectionItemsFilteredSearch.length>0&&!o.searchingCollection),e.xp6(1),e.Q6J("ngIf",o.searchQuery.trim().length>0&&!o.collectionItemsFilteredSearch.length&&!o.searchingCollection))},dependencies:[_.sg,_.O5,u._Y,u.JJ,u.JL,u.Q7,l.oU,l.YG,l.Sm,l.PM,l.FN,l.wI,l.W2,l.jY,l.Gu,l.gu,l.pK,l.Ie,l.q_,l.Nd,l.VI,l.wd,l.sr,l.ki,l.j9,l.cs,u.sg,u.u,_.Nd],styles:["[_nghost-%COMP%]   .key-value-row[_ngcontent-%COMP%]{border-bottom:1px solid grey}"]}),c})()}];let F=(()=>{var t;class c{}return(t=c).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[g.Bz.forChild(J),g.Bz]}),c})(),S=(()=>{var t;class c{}return(t=c).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.ez,u.u5,l.Pc,F,u.UX]}),c})()}}]);